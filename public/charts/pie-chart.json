{
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "description": "A basic pie chart example.",
    "width": 300,
    "height": 300,
    "padding": 20,
    "autosize": "none",
    "signals": [
      {
        "name": "startAngle", "value": 0
      },
      {
        "name": "endAngle", "value": 6.29
      },
      {
        "name": "padAngle", "value": 0
      },
      {
        "name": "innerRadius", "value": 0
      },
      {
        "name": "cornerRadius", "value": 0
      }
    ],
  
    "data": [
      {
        "name": "sp500",
        "url": "data/sp500sector.csv",
        "format": {
          "type": "csv"
        },
        "transform": [
            {
                "type": "filter",
                "expr": "datum.period === '1day'"
            },
            {
                "type": "pie",
                "field": "percentage_change",
                "startAngle": 0,
                "endAngle": 6.29
            }
        ]
      }
    ],
  
    "scales": [
      {
        "name": "color",
        "type": "ordinal",
        "domain": {"data": "sp500", "field": "sector"},
        "range": {"scheme": "category20"}
      }
    ],
  
    "marks": [
      {
        "type": "arc",
        "from": {"data": "sp500"},
        "encode": {
          "enter": {
            "fill": {"scale": "color", "field": "sector"},
            "x": {"signal": "width / 2"},
            "y": {"signal": "height / 2"},
            "tooltip": {
                "signal": "{'Sector': datum.sector, 'Percentage Change (%)': datum.percentage_change}"
              }
          },
          "update": {
            "startAngle": {"field": "startAngle"},
            "endAngle": {"field": "endAngle"},
            "padAngle": {"signal": "padAngle"},
            "innerRadius": {"signal": "innerRadius"},
            "outerRadius": {"signal": "width / 2"},
            "cornerRadius": {"signal": "cornerRadius"}
          }
        }
      }
    ]
  }